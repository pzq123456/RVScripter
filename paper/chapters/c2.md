# 第二章 相关理论基础与技术分析

## 1. GeoJSON 标准
- 术语翻译对照表： 在下表中约定对应英文术语对应的中文术语，

|英文|中文|
|--|--|
|Feature|要素|
|FeatureCollection|要素集|
|Entity|地理实体|
|Geometry|几何对象|
|Properties|属性|

- 概述：GeoJSON 是一个基于 Javascript 对象标记语言（JavaScript Object Notation）的地理数据交换格式。它定义了多种 JSON 对象及用于组合这些对象以表示地理数据的规则包括：要素、属性以及空间位置。 GeoJSON 使用 WGS84 坐标系，坐标使用（浮点数）度来记录。在 GeoJSON 中，要素包含一个几何对象及附加属性。要素集则包含一系列要素。一个 GeoJSON 对象可以表示一个区域、一个组合地理实体或要素集合。支持以下类型：Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon, GeometryCollection

GeoJSON 格式基于 OpenGIS 简单要素实现规范 (SFSQL) 中定义的七种几何类型 [SFSQL]:

- 0 维度：点 (Point) 和 多点 (MultiPoint)
- 1 维度：线 (LineString) 和 多线 (MultiLineString)
- 2 维度：面 (Polygon) 和 多面 (MultiPolygon)
- 以及异构的几何集合 (GeometryCollection)。GeoJSON 中这些几何类型的表示方式类似于该规范中描述的著名二进制 (WKB) 和 文本 (WKT) 表示方式。

GeoJSON 还包含要素 (Feature) 和要素集 (FeatureCollection) 类型。GeoJSON 中的要素对象包含一个具有上述几何类型之一的几何对象和其他成员。要素集对象包含一个要素对象数组。这种结构类似于 Web 功能服务 (WFS) 对“获取要素”请求的响应 (在 [WFSv1] 中指定) 或用于放置点的 Keyhole Markup Language (KML) 文件夹 [KMLv2.2]。WFS 规范的一些实现也为“获取要素”请求提供 GeoJSON 格式的响应，但 GeoJSON 格式规范本身并不包含特定的服务模型或要素类型本体。自 2008 年首次发布以来 [GJ2008]，GeoJSON 格式规范的流行度稳步增长。它广泛用于 JavaScript 网络地图库、基于 JSON 的文档数据库和网络 API。

出于互操作性的考量，最新版本的 GeoJSON 规范已经将替换坐标系的选项删除，GeoJSON 中存储的坐标只能是 WGS84 坐标系下的坐标。

## 2. 地理数据矢量数据模型与存储规范中的矢量数据模型
矢量数据模型包括核心数据和扩展数据。核心数据包括空间参照系、要素类和要素，扩展数据包括元数据、组合要素、注记和符号。与 GeoJSON 相类似，该标准也是将几何信息、属性信息等组合在要素对象中。其中，具体的几何类型有36种，相较于 GeoJSON 的其中几何类型主要多出了曲线及由曲线构成的几何图形。在该规范中，要素的几何信息与空间参照系关联，要素的属性信息可自行拓展，要素之间可组合成新的要素。对于空间参照系需要提供提供：空间参照系名称、唯一标识符、该定义的组织机构名称、WKT 表示以及（可选）描述信息。该标准在附录中汇总了几种可用的参照系及其 WKT 表示：1984世界大地坐标系、2000国家大地坐标系、1980西安高斯-克吕格投影坐标系、1954北京高斯-克吕格投影坐标系。可以看到，相较于 GeoJSON 标准，该标准允许使用不同的坐标系来定义地理数据，这也就意味着实现该标准的软件必须提供坐标系转换接口，否则将无法处理多种不同坐标系下数据混合出现的情况。

## 3. Node graph architecture and model builder
> - https://en.wikipedia.org/wiki/Node_graph_architecture
> - https://en.wikipedia.org/wiki/Directed_acyclic_graph
> - https://pro.arcgis.com/en/pro-app/latest/help/analysis/geoprocessing/modelbuilder/what-is-modelbuilder-.htm

1. 节点图编辑器：节点图（Node graph）可以视作一种可视化编程语言，借助于它用户可以免于操纵底层代码而直接以一种结构化、视觉化的方式编程。节点图描述了一种数据处理流程，该流程由一系列节点组成。数据从描述各种来源的节点“流出”，然后“流经”代表各种数据处理的节点，最后“流入”表示输出或目的地的节点。用户可以根据工作流的实际需要串连节点，复杂一点的节点甚至可以在面板中调节参数（例如阈值、最大执行次数等）。这样做可以将一个复杂庞大的任务分解为若干相对简单的子任务，并以一种直观的、易于控制的方式展现给用户。支持节点图编程的软件一般会将用于支撑软件功能的底层代码封装进称为节点的单元中，一般节点会有一个共同的、输入输出为空的基类，在继承的同时使用自身的输入输出数据结构覆盖基类。节点可以连接其他节点，一旦当前节点的计算任务结束，系统就会将中间结果传入连接的另一端。
2. GIS 软件中的节点图编辑器：节点图编辑器一般用于可视化创建复杂数据的自动化处理工作流，比较经典的用例有三维渲染软件中的自定义材质工作流及骨骼动画工作流等。地理信息系统同样需要处理复杂数据，需要对大量繁杂的处理工作构建自动化工作流，因此与三维渲染软件中相似的可视化工作流编辑模式也自然存在与主流的 GIS 软件中。
   1. ArcGIS 模型构建器（ModelBuilder）是一种可视化编程语言，主要用于构建地理处理自动化工作流。一个工作流模型主要包括四种基本元素类型：地理处理工具、变量、连接符和组。地理处理工具用于对地理数据或表格数据执行多种操作。变量是模型中用于保存值或对数据进行引用的元素。连接符用于将数据和值连接到工具，并明确数据处理方向。组是用于概化子工作流细节的可折叠的视觉元素。
   2. QGIS 模型设计器（model designer）允许用户通过简单易用的界面创建复杂模型。在地理信息系统 (GIS) 工作中，大多数分析操作并非孤立进行，而是作为操作链的一部分。使用模型设计器，可以将操作链封装成单个进程，方便以后使用不同的输入集再次执行。无论模型包含多少步骤和不同的算法，它都将作为一个整体算法执行，从而节省时间和精力。
   3. 超图地理处理建模是一种可视化建模语言，用于构建空间数据处理流程。它由工具箱、工具、数据变量、连接和虚拟数据等元素组成，具有可视化、易用、灵活等特点，可广泛应用于地理信息系统领域的数据处理、分析、建模等工作。工具箱 提供了各种地理数据处理、分析工具，是模型构成的基本单元。工具 是模型的基本构建要素，支持设置输入、输出和功能参数。数据变量 方便地将多个工具与同一数据相关联，提升模型可读性。连接 建立工具之间的逻辑和参数关系。虚拟数据支持模型流程的完整构建，降低模型参数设置复杂度。
   4. 通过分析上述成熟软件，我们发现 GIS 软件中的节点图易用性背后隐藏着许多技术细节。首先是自定义封装与复用，用户可以自行使用软件提供的各类节点（底层是功能接口）自定义工作流并以各种形式（文件、内存）保存下来。其次，为了不阻塞软件的运行造成不必要的卡顿，运行用户自定义工作流需要在主线程之外开辟一个独立的线程。

## 现代浏览器技术特性

分析样例：https://help.supermap.com/iDesktop/zh/tutorial/workflow/WorkFlowApplications
